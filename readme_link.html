<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python Edge Evaluation Tools &mdash; pyEdgeEval 0.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyEdgeEval package" href="pyEdgeEval.html" />
    <link rel="prev" title="Welcome to pyEdgeEval’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pyEdgeEval
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python Edge Evaluation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-guide">Installation guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#converting-cityscapes-dataset-for-sbd">Converting Cityscapes Dataset for SBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="#evaluation-for-each-datasets">Evaluation for each datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bsds500">BSDS500</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sbd">SBD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cityscapes">CityScapes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="#development">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyEdgeEval.html">pyEdgeEval package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyEdgeEval</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Python Edge Evaluation Tools</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/readme_link.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-edge-evaluation-tools">
<h1>Python Edge Evaluation Tools<a class="headerlink" href="#python-edge-evaluation-tools" title="Permalink to this heading">¶</a></h1>
<p>Edge detection tasks heavily relies on the original codes used in BSDS300/500 that runs on <a class="reference external" href="https://www2.eecs.berkeley.edu/Research/Projects/CS/vision/grouping/resources.html">MATLAB</a>.
In the field of computer vision, various edge detection algorithms are now resorting to Python which supports various machine learning libraries.
However, not everyone has access to MATLAB and the original benchmark codes are outdated.
I created this open-source library, <code class="docutils literal notranslate"><span class="pre">pyEdgeEval</span></code>, to make it easier to evaluate and reproduce recent deep learning models for edge and boundary detection.
The original C++ codes used in the MATLAB benchmarks are ported with Cython and the evaluation scripts are rewritten in Python3.
This means that benchmarking could be easily done on almost any environment, especially on remote servers (i.e., linux environments, docker containers), which have been difficult before.
The codebase is designed to be extensible and supports various tasks and datasets as well as different evaluation protocols.
To test the validity of the evaluation code, <code class="docutils literal notranslate"><span class="pre">pyEdgeEval</span></code>’s results are compared with the results of the original MATLAB codes.
Besides benchmarking, <code class="docutils literal notranslate"><span class="pre">pyEdgeEval</span></code> adds various tools for edge detection such as <code class="docutils literal notranslate"><span class="pre">mask2edge</span></code> transformation.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyEdgeEval</span></code> is:</p>
<ul class="simple">
<li><p>a Python alternative to the original MATLAB benchmark</p></li>
<li><p>light with minimal dependencies</p></li>
<li><p>modular architecture and easily customizable</p></li>
<li><p>relatively fast (uses multiprocessing and Cython)</p></li>
<li><p>implements common preprocessing algorithms</p></li>
<li><p>supports various tasks and datasets (extensible to other datasets)</p></li>
<li><p>supports various evaluation protocols</p></li>
<li><p>edge generation tools</p></li>
<li><p>etc…</p></li>
</ul>
<p><strong>Supported tasks</strong>:</p>
<ul class="simple">
<li><p>Edge Detection</p></li>
<li><p>Semantic Boundary Detection</p></li>
</ul>
<p><strong>Supported datasets</strong>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www2.eecs.berkeley.edu/Research/Projects/CS/vision/grouping/resources.html">BSDS500</a></p></li>
<li><p><a class="reference external" href="http://home.bharathh.info/pubs/codes/SBD/download.html">SBD</a></p></li>
<li><p><a class="reference external" href="https://www.cityscapes-dataset.com">Cityscapes</a> (semantic boundary detection)</p></li>
</ul>
<p><em>Disclaimers</em>:</p>
<ul class="simple">
<li><p>The evaluation code does not output results that exactly match the original MATLAB benchmark. This could be for various reasons such as random seeds for matching algorithm. The results are, for the most part, close enough (around 0.01% difference).</p></li>
<li><p>The codes and algorithms are not perfect. I will not take responsibility for how the code is used (check the license(s)).</p></li>
<li><p>If you find some bugs or want to improve this project, please submit issues or pull requests.</p></li>
</ul>
</section>
<section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h1>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">&gt;=</span> <span class="pre">3.8</span></code> (tested on 3.8.x)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2</span></code></p></li>
</ul>
</section>
<section id="installation-guide">
<h2>Installation guide<a class="headerlink" href="#installation-guide" title="Permalink to this heading">¶</a></h2>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install dependencies</span>
pip install -r requirements.txt

<span class="c1"># install cv2 (e.g. use pip)</span>
pip install opencv-python

<span class="c1"># Option 1. install without cloning the project (only tested on ubuntu with python 3.8)</span>
pip install pyEdgeEval

<span class="c1"># Option 2. install as a pip package (install as a package)</span>
git clone https://github.com/haruishi43/py-edge-eval.git
pip install -e .
</pre></div>
</div>
</section>
</section>
<section id="converting-cityscapes-dataset-for-sbd">
<h1>Converting Cityscapes Dataset for SBD<a class="headerlink" href="#converting-cityscapes-dataset-for-sbd" title="Permalink to this heading">¶</a></h1>
<p>Script:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>python scripts/convert_datasets/cityscapes.py --nproc<span class="o">=</span><span class="m">8</span>
</pre></div>
</div>
<p>NOTE:</p>
<ul class="simple">
<li><p>Beaware that using multi-processing will consume at most 10GB per process (I’m working on debugging memory allocation issues).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--nonIS</span></code> will generate non-IS boundaries.</p></li>
<li><p>The script will generate full resolution training dataset, full resolution validation dataset, and half resolution validation dataset (both raw/thin for validation).</p></li>
</ul>
</section>
<section id="evaluation-for-each-datasets">
<h1>Evaluation for each datasets<a class="headerlink" href="#evaluation-for-each-datasets" title="Permalink to this heading">¶</a></h1>
<section id="bsds500">
<h2>BSDS500<a class="headerlink" href="#bsds500" title="Permalink to this heading">¶</a></h2>
<p>Script:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>python scripts/evaluate_bsds500.py &lt;path/to/bsds500&gt; &lt;path/to/pred&gt; &lt;path/to/output&gt; --thresholds<span class="o">=</span><span class="m">5</span> --nproc<span class="o">=</span><span class="m">8</span>
</pre></div>
</div>
<p>Tested with <a class="reference external" href="https://github.com/xwjabc/hed">&#64;xwjabc’s HED implementation</a>.
Setting <code class="docutils literal notranslate"><span class="pre">--nproc</span></code> will drastically improve the evaluation.
However, due to the randomness in the original MATLAB (C++) codebase, the results will be different (at most +-0.001 difference).</p>
</section>
<section id="sbd">
<h2>SBD<a class="headerlink" href="#sbd" title="Permalink to this heading">¶</a></h2>
<p>Script:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>python scripts/evaluate_sbd.py &lt;path/to/sbd&gt; &lt;path/to/pred&gt; &lt;path/to/output&gt; --categories<span class="o">=</span><span class="m">15</span> --thresholds<span class="o">=</span><span class="m">5</span> --nproc<span class="o">=</span><span class="m">8</span>
</pre></div>
</div>
</section>
<section id="cityscapes">
<h2>CityScapes<a class="headerlink" href="#cityscapes" title="Permalink to this heading">¶</a></h2>
<p>First, create GT data using this script:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you plan on evaluating with instance-sensitive edges (IS edges)</span>
python scripts/convert_dataset/cityscapes.py --nproc <span class="m">8</span>
<span class="c1"># if you plan on evaluating with non-instance-sensitive edges</span>
python scripts/convert_dataset/cityscapes.py --nonIS --nproc <span class="m">8</span>
</pre></div>
</div>
<p>The scripts will create two types of edges (raw and thin) for two different scales (half and full).</p>
<p>Evaluation script:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>python scripts/evaluate_cityscapes.py &lt;path/to/cityscapes&gt; &lt;path/to/predictions&gt; &lt;path/to/output&gt; --categories<span class="o">=</span><span class="s1">&#39;[1, 14]&#39;</span> --thresholds <span class="m">99</span> --nproc <span class="m">8</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--thin</span></code> will enable thinning on predictions and use thinned GTs.
For instance-insensitive edges, you would need to supply <code class="docutils literal notranslate"><span class="pre">--pre-seal</span></code> argument.
You can also preprocess the predictions by passing <code class="docutils literal notranslate"><span class="pre">--apply-thinning</span></code> and/or <code class="docutils literal notranslate"><span class="pre">--apply-nms</span></code> for thinning and NMS respectively.</p>
</section>
</section>
<section id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>The code is released under the MIT License (please refer to the LICENSE file for details).</p></li>
<li><p>I modified codes from other projects and their licenses applies to those files (please refer to <span class="xref myst">Licenses</span>).</p></li>
</ul>
</section>
<section id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this heading">¶</a></h1>
<p>See <span class="xref myst">dev.md</span>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to pyEdgeEval’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pyEdgeEval.html" class="btn btn-neutral float-right" title="pyEdgeEval package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, haruishi43.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>